---
description: Rules for updating Fumadocs content under content/.
globs: content/**
alwaysApply: true
---

# Update Docs Rules

These rules govern the `update-docs` skill, which generates and updates the derived Fumadocs content under `content/` from `src/sources/` and the ontology schema in `.cursor/rules/ontology.mdc`.

- **Derived Content**: All files under `content/` are considered derived from `src/sources/` and the ontology schema. The `update-docs` skill is the primary mechanism for modifying `content/`.
- **Idempotency**: The `update-docs` skill must operate idempotently. Re-running the skill with the same `src/sources/` and ontology inputs should produce the same `content/` output, updating existing files rather than creating duplicates.
- **Provenance**: Each file under `content/` must include frontmatter or a section that clearly links back to the specific `src/sources/` IDs from which its content was derived (e.g., `source_ids: [source_id_1, source_id_2]`).
- **Ontology Adherence**: The structure, naming, and content of files under `content/` must strictly conform to the schema defined in `.cursor/rules/ontology.mdc`.
- **Protected Sections**: When updating `content/` files, sections marked by `<!-- AGENT_PROTECTED_START -->` and `<!-- AGENT_PROTECTED_END -->` markers must be preserved and not overwritten. These sections are reserved for manual user edits.
- **Fumadocs Compatibility**: Ensure that `content/meta.json` (and any subfolder `meta.json` files) are kept valid and up-to-date to maintain correct navigation and structure within the Fumadocs site.
- **Media Mirroring**: As part of `update-docs`, mirror `src/media/` to `public/media/` so assets are available at `/media/...` URLs.
- **Embedding images**: Generated content under `content/` must embed images referenced in `src/sources/` (via `media_refs` or inline links). Use web paths `/media/YYYY-MM-DD_short_descriptive_name/filename.ext` in MDX. Place each image **after** the related block of text; the docs site uses Fumadocs ImageZoom for `img` elements, so standard Markdown image syntax in MDX gets zoom automatically.

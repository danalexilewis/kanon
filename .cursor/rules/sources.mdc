---
description: Rules for content and structure within the sources/ directory.
globs: sources/**
alwaysApply: true
---

# Sources Rules

These rules govern the creation, content, and structure of Markdown files within the `sources/` directory. `sources/` is the canonical, normalized, user-created source corpus.

- **Format**: All files under `sources/` must be Markdown (`.md` or `.mdx`) with a YAML frontmatter block at the top.
- **Standardized Frontmatter**: Each source file must include the following frontmatter fields:
  - `id`: A stable, unique identifier for the source (e.g., derived from date and slug).
  - `source_type`: One of `document`, `chat`, `transcript`, or `media`.
  - `weight`: A numeric value representing the source's importance (e.g., `1.0` for documents, `0.7` for chats, `0.5` for transcripts, `0.4` for media).
  - `title`: A descriptive title for the source.
  - `created_at`: The creation or capture date/time in ISO8601 format.
  - `ingest_paths`: A list of relative paths to the original files in `ingest/` from which this source was derived.
  - `ingest_hashes`: A list of SHA256 (or similar) hashes of the original `ingest/` files, used for idempotency.
- **Optional Frontmatter**: Common optional fields include `people`, `orgs`, `tags`, `language`, `confidence`, `needs_review`, and `media_refs` (a list of paths to related media assets in `media/`).
- **Folder Organization**: Source files must be placed in the appropriate subfolder:
  - `sources/documents/`: For processed documents.
  - `sources/chats/`: For processed chat logs.
  - `sources/transcripts/`: For processed audio/video transcripts.
  - `sources/media/`: For Markdown metadata/notes related to binary media assets (which live in `media/`).
- **Protected Sections**: When source files are updated by skills (e.g., `ingest`, `ingest-force`), sections marked with `<!-- AGENT_PROTECTED_START -->` and `<!-- AGENT_PROTECTED_END -->` markers must be preserved and not overwritten.
- **Source of Truth**: The `sources/` directory is the canonical representation of user-created knowledge. If `sources/` content and `content/` (Fumadocs output) disagree, `sources/` is the source of truth; `content/` should be updated to reflect `sources/`.
